# Firewall Editor - Quick Reference Card

## ðŸŽ¯ One-Page Reference

### URLs
```
Web Interface:  http://localhost:8080/tool/firewall-editor.php
Public API:     http://localhost:8080/get-iptables.php
```

### API Endpoints
```
POST   /api/v1/firewall/upload     # Upload config file
POST   /api/v1/firewall/save       # Save configuration
GET    /api/v1/firewall/list       # List configurations
GET    /api/v1/firewall/get        # Get specific config
GET    /api/v1/firewall/diff       # Compare versions
GET    /api/v1/firewall/export     # Export configuration
```

### Database Tables
```sql
firewall_configs      # Main configuration storage
firewall_tags         # Organization tags
firewall_deployments  # Deployment tracking
```

### Common Commands

#### Setup
```bash
# Run migration
psql -U veribits_user -d veribits < db/migrations/012_firewall_configs.sql

# Make scripts executable
chmod +x scripts/get-firewall-config.sh
chmod +x tests/test-firewall-editor.sh

# Run tests
./tests/test-firewall-editor.sh
```

#### CLI Retrieval
```bash
# Text format
curl "http://localhost:8080/get-iptables.php?key=API_KEY&device=server-01"

# JSON format
curl "http://localhost:8080/get-iptables.php?key=API_KEY&device=server-01&output=json"

# Using script
./scripts/get-firewall-config.sh -k API_KEY -d server-01 -f /tmp/fw.rules

# Apply (requires root)
sudo ./scripts/get-firewall-config.sh -k API_KEY -d server-01 --apply
```

#### API Examples
```bash
# Upload config
curl -X POST http://localhost:8080/api/v1/firewall/upload \
  -H "Authorization: Bearer TOKEN" \
  -F "config_file=@fw.rules" \
  -F "firewall_type=iptables" \
  -F "device_name=server-01"

# Save config
curl -X POST http://localhost:8080/api/v1/firewall/save \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "config_type": "iptables",
    "config_data": "...",
    "device_name": "server-01",
    "description": "Version 1"
  }'

# List configs
curl http://localhost:8080/api/v1/firewall/list \
  -H "Authorization: Bearer TOKEN"

# Get specific config
curl "http://localhost:8080/api/v1/firewall/get?id=UUID" \
  -H "Authorization: Bearer TOKEN"

# Compare versions
curl "http://localhost:8080/api/v1/firewall/diff?old=UUID1&new=UUID2" \
  -H "Authorization: Bearer TOKEN"
```

### File Locations
```
Frontend:    app/public/tool/firewall-editor.php
JavaScript:  app/public/assets/js/firewall-editor.js
Controller:  app/src/Controllers/FirewallController.php
Public API:  app/public/get-iptables.php
Migration:   db/migrations/012_firewall_configs.sql
CLI Script:  scripts/get-firewall-config.sh
Tests:       tests/test-firewall-editor.sh
```

### Supported Firewall Types
```
iptables   # IPv4 packet filtering
ip6tables  # IPv6 packet filtering
ebtables   # Layer 2 bridge firewall
```

### Rule Targets (Color Coded)
```
ACCEPT      # Green - Allow traffic
DROP        # Red - Silently drop
REJECT      # Red - Drop with response
LOG         # Yellow - Log packet
RETURN      # Blue - Return to calling chain
DNAT        # Destination NAT
SNAT        # Source NAT
MASQUERADE  # Dynamic NAT
```

### Common Rule Options
```
-p, --protocol      # tcp, udp, icmp, all
-s, --source        # Source IP/CIDR
-d, --destination   # Destination IP/CIDR
-i, --in-interface  # Input interface (eth0, wlan0)
-o, --out-interface # Output interface
--sport             # Source port(s)
--dport             # Destination port(s)
-m state --state    # NEW, ESTABLISHED, RELATED, INVALID
-m comment --comment # Add comment to rule
-j, --jump          # Target (ACCEPT, DROP, etc.)
```

### Sample iptables-save Format
```bash
# Generated by iptables-save
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -i lo -j ACCEPT
-A INPUT -p tcp --dport 22 -j ACCEPT
-A INPUT -p tcp --dport 80 -j ACCEPT
-A INPUT -p tcp --dport 443 -j ACCEPT
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
COMMIT
```

### Environment Variables
```bash
VERIBITS_API_KEY     # Your API key
VERIBITS_ACCOUNT     # Account ID
VERIBITS_DEVICE      # Device name
VERIBITS_VERSION     # Config version
VERIBITS_URL         # API URL
```

### Rate Limits
```
Uploads: 20 per hour per user
```

### File Size Limits
```
Upload: 10 MB max
```

### Security Features
- âœ… Authentication required
- âœ… API key support
- âœ… Rate limiting
- âœ… Audit logging
- âœ… User isolation
- âœ… Input validation

### Quick Troubleshooting
```bash
# Check database
psql -U veribits_user -d veribits -c "\dt firewall*"

# Check routes
grep -n "firewall" app/public/index.php

# Test API
curl http://localhost:8080/api/v1/health

# Check logs
tail -f /var/log/veribits/app.log

# Verify permissions
ls -la scripts/get-firewall-config.sh
```

### Documentation Links
```
Quick Start:    FIREWALL_EDITOR_QUICKSTART.md
Full Docs:      FIREWALL_EDITOR_DOCUMENTATION.md
Architecture:   FIREWALL_EDITOR_ARCHITECTURE.md
Summary:        FIREWALL_EDITOR_SUMMARY.md
Delivery:       FIREWALL_EDITOR_DELIVERY.md
```

### Support
```
Email:  support@veribits.com
Docs:   https://veribits.com/docs/firewall-editor
API:    https://veribits.com/api/v1/docs
```

---

**Print this page for quick reference!**

Â© 2025 After Dark Systems, LLC
